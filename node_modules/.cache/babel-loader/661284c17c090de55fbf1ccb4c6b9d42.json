{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Image = void 0;\n\nvar Util_1 = require(\"../Util\");\n\nvar Factory_1 = require(\"../Factory\");\n\nvar Shape_1 = require(\"../Shape\");\n\nvar Validators_1 = require(\"../Validators\");\n\nvar Global_1 = require(\"../Global\");\n\nvar Image = function (_super) {\n  __extends(Image, _super);\n\n  function Image() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Image.prototype._useBufferCanvas = function () {\n    return _super.prototype._useBufferCanvas.call(this, true);\n  };\n\n  Image.prototype._sceneFunc = function (context) {\n    var width = this.getWidth();\n    var height = this.getHeight();\n    var image = this.attrs.image;\n    var params;\n\n    if (image) {\n      var cropWidth = this.attrs.cropWidth;\n      var cropHeight = this.attrs.cropHeight;\n\n      if (cropWidth && cropHeight) {\n        params = [image, this.cropX(), this.cropY(), cropWidth, cropHeight, 0, 0, width, height];\n      } else {\n        params = [image, 0, 0, width, height];\n      }\n    }\n\n    if (this.hasFill() || this.hasStroke()) {\n      context.beginPath();\n      context.rect(0, 0, width, height);\n      context.closePath();\n      context.fillStrokeShape(this);\n    }\n\n    if (image) {\n      context.drawImage.apply(context, params);\n    }\n  };\n\n  Image.prototype._hitFunc = function (context) {\n    var width = this.width(),\n        height = this.height();\n    context.beginPath();\n    context.rect(0, 0, width, height);\n    context.closePath();\n    context.fillStrokeShape(this);\n  };\n\n  Image.prototype.getWidth = function () {\n    var _a, _b;\n\n    return (_a = this.attrs.width) !== null && _a !== void 0 ? _a : ((_b = this.image()) === null || _b === void 0 ? void 0 : _b.width) || 0;\n  };\n\n  Image.prototype.getHeight = function () {\n    var _a, _b;\n\n    return (_a = this.attrs.height) !== null && _a !== void 0 ? _a : ((_b = this.image()) === null || _b === void 0 ? void 0 : _b.height) || 0;\n  };\n\n  Image.fromURL = function (url, callback) {\n    var img = Util_1.Util.createImageElement();\n\n    img.onload = function () {\n      var image = new Image({\n        image: img\n      });\n      callback(image);\n    };\n\n    img.crossOrigin = 'Anonymous';\n    img.src = url;\n  };\n\n  return Image;\n}(Shape_1.Shape);\n\nexports.Image = Image;\nImage.prototype.className = 'Image';\n\nGlobal_1._registerNode(Image);\n\nFactory_1.Factory.addGetterSetter(Image, 'image');\nFactory_1.Factory.addComponentsGetterSetter(Image, 'crop', ['x', 'y', 'width', 'height']);\nFactory_1.Factory.addGetterSetter(Image, 'cropX', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Image, 'cropY', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Image, 'cropWidth', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Image, 'cropHeight', 0, Validators_1.getNumberValidator());\nUtil_1.Collection.mapMethods(Image);","map":{"version":3,"sources":["/home/namina/courses/tinkoff/paint-your-face/node_modules/konva/lib/shapes/Image.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__","constructor","create","defineProperty","exports","value","Image","Util_1","require","Factory_1","Shape_1","Validators_1","Global_1","_super","apply","arguments","_useBufferCanvas","_sceneFunc","context","width","getWidth","height","getHeight","image","attrs","params","cropWidth","cropHeight","cropX","cropY","hasFill","hasStroke","beginPath","rect","closePath","fillStrokeShape","drawImage","_hitFunc","_a","_b","fromURL","url","callback","img","Util","createImageElement","onload","crossOrigin","src","Shape","className","_registerNode","Factory","addGetterSetter","addComponentsGetterSetter","getNumberValidator","Collection","mapMethods"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Image = void 0;\nvar Util_1 = require(\"../Util\");\nvar Factory_1 = require(\"../Factory\");\nvar Shape_1 = require(\"../Shape\");\nvar Validators_1 = require(\"../Validators\");\nvar Global_1 = require(\"../Global\");\nvar Image = (function (_super) {\n    __extends(Image, _super);\n    function Image() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Image.prototype._useBufferCanvas = function () {\n        return _super.prototype._useBufferCanvas.call(this, true);\n    };\n    Image.prototype._sceneFunc = function (context) {\n        var width = this.getWidth();\n        var height = this.getHeight();\n        var image = this.attrs.image;\n        var params;\n        if (image) {\n            var cropWidth = this.attrs.cropWidth;\n            var cropHeight = this.attrs.cropHeight;\n            if (cropWidth && cropHeight) {\n                params = [\n                    image,\n                    this.cropX(),\n                    this.cropY(),\n                    cropWidth,\n                    cropHeight,\n                    0,\n                    0,\n                    width,\n                    height,\n                ];\n            }\n            else {\n                params = [image, 0, 0, width, height];\n            }\n        }\n        if (this.hasFill() || this.hasStroke()) {\n            context.beginPath();\n            context.rect(0, 0, width, height);\n            context.closePath();\n            context.fillStrokeShape(this);\n        }\n        if (image) {\n            context.drawImage.apply(context, params);\n        }\n    };\n    Image.prototype._hitFunc = function (context) {\n        var width = this.width(), height = this.height();\n        context.beginPath();\n        context.rect(0, 0, width, height);\n        context.closePath();\n        context.fillStrokeShape(this);\n    };\n    Image.prototype.getWidth = function () {\n        var _a, _b;\n        return (_a = this.attrs.width) !== null && _a !== void 0 ? _a : (((_b = this.image()) === null || _b === void 0 ? void 0 : _b.width) || 0);\n    };\n    Image.prototype.getHeight = function () {\n        var _a, _b;\n        return (_a = this.attrs.height) !== null && _a !== void 0 ? _a : (((_b = this.image()) === null || _b === void 0 ? void 0 : _b.height) || 0);\n    };\n    Image.fromURL = function (url, callback) {\n        var img = Util_1.Util.createImageElement();\n        img.onload = function () {\n            var image = new Image({\n                image: img,\n            });\n            callback(image);\n        };\n        img.crossOrigin = 'Anonymous';\n        img.src = url;\n    };\n    return Image;\n}(Shape_1.Shape));\nexports.Image = Image;\nImage.prototype.className = 'Image';\nGlobal_1._registerNode(Image);\nFactory_1.Factory.addGetterSetter(Image, 'image');\nFactory_1.Factory.addComponentsGetterSetter(Image, 'crop', ['x', 'y', 'width', 'height']);\nFactory_1.Factory.addGetterSetter(Image, 'cropX', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Image, 'cropY', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Image, 'cropWidth', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Image, 'cropHeight', 0, Validators_1.getNumberValidator());\nUtil_1.Collection.mapMethods(Image);\n"]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"var _jsxFileName = \"/home/namina/courses/tinkoff/paint-your-face/src/components/canvas/Canvas.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, Fragment, useState } from 'react';\nimport Palette from '../Palette/Palette';\nimport Buttons from '../Buttons';\nimport styles from '../Gallery.module.css';\n/*let paths = [];\nlet points = [];\nlet drawing = false;*/\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst draw = (canvas, color, mode) => {\n  let context = canvas.getContext('2d');\n\n  canvas.onmousemove = function drawIfPressed(e) {\n    let x = e.offsetX;\n    let y = e.offsetY;\n    let dx = e.movementX;\n    let dy = e.movementY;\n    context.globalCompositeOperation = mode === 'line' ? \"source-over\" : \"destination-out\";\n    context.lineCap = \"round\";\n    context.lineWidth = 8;\n\n    if (e.buttons > 0) {\n      context.beginPath();\n      context.moveTo(x, y);\n      context.lineTo(x - dx, y - dy);\n      context.stroke();\n      context.strokeStyle = color;\n      context.closePath();\n    }\n    /*if(drawing){\n        points.push({x:x-dx, y:y-dy})\n    }*/\n\n  };\n  /*canvas.onmouseup = (e) => {//не нажата\n      console.log('not')\n      paths.push(points);\n      drawing=false;\n  };*/\n\n  /*canvas.onmousedown = (e)=>{//нажата\n      drawing=true;\n      let x = e.offsetX;\n      let y = e.offsetY;\n      let dx = e.movementX;\n      let dy = e.movementY;\n      points = [];\n      points.push({x:x-dx, y:y-dy})\n      console.log('on')\n  };*/\n\n};\n/*const drawPaths=(canvas)=> {\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0,0,canvas.width,canvas.height);\n  // draw all the paths in the paths array\n    paths.forEach(path=>{\n    ctx.beginPath();\n    ctx.moveTo(path[0].x,path[0].y);  \n    for(let i = 1; i < path.length; i++){\n        ctx.lineTo(path[i].x,path[i].y); \n    }\n    ctx.stroke();\n    })\n};*/\n\n\nconst Canvas = props => {\n  _s();\n\n  let [color, setColor] = useState('black');\n  let [gallery, setImage] = useState([]); //let [points, setPoint] = useState([]);\n\n  const canvasRef = useRef(null);\n\n  const onChangeColor = color => {\n    setColor(color);\n  };\n\n  const save = () => {\n    const canvas = canvasRef.current;\n    let size = localStorage.length;\n    let dataURL = canvas.toDataURL(\"image/png\", 1.0);\n    localStorage.setItem(`gallery${size + 1}`, dataURL);\n    addNewImg(dataURL);\n  };\n\n  const clear = () => {\n    const canvas = canvasRef.current;\n    const context = canvas.getContext('2d');\n    context.clearRect(0, 0, canvas.width, canvas.height);\n    points = [];\n    paths = [];\n  };\n\n  const eraser = () => {\n    const canvas = canvasRef.current;\n    draw(canvas, \"rgb(255, 255, 255, 1)\", 'eraser');\n  };\n\n  const addNewImg = dataURL => {\n    setImage([...gallery, /*#__PURE__*/_jsxDEV(\"img\", {\n      src: dataURL,\n      className: styles.picture\n    }, dataURL, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 31\n    }, this)]);\n  };\n  /* const undo = () => {\n       const canvas = canvasRef.current\n       paths.splice(-1,1);\n       drawPaths(canvas);\n   }*/\n\n\n  useEffect(() => {\n    const canvas = canvasRef.current; // const context = canvas.getContext('2d');\n\n    draw(canvas, color, 'line');\n  }, [draw, color, gallery]);\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.gallery,\n      children: gallery\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      className: styles.canvas,\n      width: \"450\",\n      height: \"450\",\n      ref: canvasRef,\n      ...props\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Buttons, {\n      clear: clear,\n      save: save,\n      eraser: eraser\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Palette, {\n      onChangeColor: onChangeColor\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 10\n  }, this);\n}; // <Buttons clear={clear(canvasRef.getContext('2d'))} />\n\n\n_s(Canvas, \"mmReg72U4XcRSkNyFAFuIkz5o1U=\");\n\n_c = Canvas;\nexport default Canvas;\n\nvar _c;\n\n$RefreshReg$(_c, \"Canvas\");","map":{"version":3,"sources":["/home/namina/courses/tinkoff/paint-your-face/src/components/canvas/Canvas.js"],"names":["React","useRef","useEffect","Fragment","useState","Palette","Buttons","styles","draw","canvas","color","mode","context","getContext","onmousemove","drawIfPressed","e","x","offsetX","y","offsetY","dx","movementX","dy","movementY","globalCompositeOperation","lineCap","lineWidth","buttons","beginPath","moveTo","lineTo","stroke","strokeStyle","closePath","Canvas","props","setColor","gallery","setImage","canvasRef","onChangeColor","save","current","size","localStorage","length","dataURL","toDataURL","setItem","addNewImg","clear","clearRect","width","height","points","paths","eraser","picture"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, Fragment, useState } from 'react';\nimport Palette from '../Palette/Palette';\nimport Buttons from '../Buttons';\nimport styles from '../Gallery.module.css';\n/*let paths = [];\nlet points = [];\nlet drawing = false;*/\nconst draw = (canvas, color, mode) => {\n    let context = canvas.getContext('2d');\n    canvas.onmousemove = function drawIfPressed (e) {\n        let x = e.offsetX;\n        let y = e.offsetY;\n        let dx = e.movementX;\n        let dy = e.movementY;\n        context.globalCompositeOperation = mode==='line'? \"source-over\": \"destination-out\";\n        context.lineCap = \"round\";\n        context.lineWidth = 8;\n        if (e.buttons > 0) {\n          context.beginPath();\n          context.moveTo(x, y);\n          context.lineTo(x - dx, y - dy);\n          context.stroke();\n          context.strokeStyle = color;\n          context.closePath();\n        }\n        /*if(drawing){\n            points.push({x:x-dx, y:y-dy})\n        }*/\n    };\n    /*canvas.onmouseup = (e) => {//не нажата\n        console.log('not')\n        paths.push(points);\n        drawing=false;\n    };*/\n    /*canvas.onmousedown = (e)=>{//нажата\n        drawing=true;\n        let x = e.offsetX;\n        let y = e.offsetY;\n        let dx = e.movementX;\n        let dy = e.movementY;\n        points = [];\n        points.push({x:x-dx, y:y-dy})\n        console.log('on')\n    };*/\n}\n\n/*const drawPaths=(canvas)=> {\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0,0,canvas.width,canvas.height);\n  // draw all the paths in the paths array\n    paths.forEach(path=>{\n    ctx.beginPath();\n    ctx.moveTo(path[0].x,path[0].y);  \n    for(let i = 1; i < path.length; i++){\n        ctx.lineTo(path[i].x,path[i].y); \n    }\n    ctx.stroke();\n    })\n};*/\n\nconst Canvas = props => {\n    let [color, setColor] = useState('black');\n    let [gallery, setImage] = useState([]);\n    //let [points, setPoint] = useState([]);\n    const canvasRef = useRef(null);\n    const onChangeColor = color => {\n        setColor(color);\n    };\n    const save = () => {\n        const canvas = canvasRef.current\n        let size = localStorage.length;\n        let dataURL = canvas.toDataURL(\"image/png\", 1.0);\n        localStorage.setItem(`gallery${size+1}`, dataURL)\n        addNewImg(dataURL); \n    };\n    const clear = () => {\n        const canvas = canvasRef.current\n        const context = canvas.getContext('2d');\n        context.clearRect(0, 0, canvas.width, canvas.height);\n        points=[];\n        paths=[];\n    };\n    const eraser = () => {\n        const canvas = canvasRef.current\n        draw(canvas,\"rgb(255, 255, 255, 1)\",'eraser');\n    };\n    const addNewImg = (dataURL) => {\n        setImage([...gallery, <img key={dataURL} src={dataURL} className={styles.picture}/>]);\n    }\n   /* const undo = () => {\n        const canvas = canvasRef.current\n        paths.splice(-1,1);\n        drawPaths(canvas);\n    }*/\n    useEffect(() => {\n        const canvas = canvasRef.current\n       // const context = canvas.getContext('2d');\n        draw(canvas, color,'line');\n    }, [draw, color, gallery])\n  \n  return <Fragment>\n    <div className={styles.gallery}>{gallery}</div>\n    <canvas className={styles.canvas} width='450' height='450' ref={canvasRef} {...props}/>\n    <Buttons clear={clear} save ={save} eraser={eraser} />\n    <Palette onChangeColor={onChangeColor}></Palette>\n  </Fragment> \n}\n// <Buttons clear={clear(canvasRef.getContext('2d'))} />\nexport default Canvas;"]},"metadata":{},"sourceType":"module"}